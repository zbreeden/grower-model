<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Git — The Grower Module</title>
  <link rel="stylesheet" href="../../assets/style.css" />
  <meta name="description" content="Git quickstart, repo layout, and Pages deploy for The Grower." />
  <script>
    // Lightweight analytics hooks (compatible with GTM/GA4)
    window.dataLayer = window.dataLayer || [];
    function push(event, params = {}) { dataLayer.push({ event, ...params }); }
    document.addEventListener("DOMContentLoaded", () =>
      push("page_view", { module: "git" })
    );
  </script>
  <style>
    .kbd { display:inline-block;padding:2px 6px;border:1px solid var(--border);border-radius:6px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-size:12px;color:var(--text) }
    pre { margin: 8px 0 12px; padding: 12px; border:1px solid var(--border); border-radius: 10px; background: rgba(255,255,255,.03); overflow:auto }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace }
    .row { display:flex; gap:8px; align-items:center; justify-content:flex-start; flex-wrap:wrap }
    .small { font-size: 13px; color: var(--muted) }
    .copy-btn { white-space:nowrap }
  </style>
</head>
<body class="wrap">
  <p><a href="../../">← Back</a></p>

  <h1>Git for <em>The Grower</em></h1>
  <p class="muted">Quickstart, repo layout, and GitHub Pages deployment — distilled from the project README.</p>

  <div class="grid">
    <!-- Quickstart -->
    <section class="card">
      <h2>Quickstart (new repo)</h2>
      <p>Initialize, commit, and push the scaffold to a new GitHub repo.</p>
      <div class="row">
        <span class="small">Create an empty repo on GitHub first (no README).</span>
        <button class="btn ghost copy-btn" data-copy="#qs1" data-label="Copy Quickstart">Copy</button>
      </div>
      <pre id="qs1"><code>git init
git branch -m main
git add .
git commit -m "feat: seed The Grower scaffold"
git remote add origin https://github.com/&lt;your-username&gt;/&lt;your-repo&gt;.git
git push -u origin main</code></pre>

      <details>
        <summary class="small">Have an existing repo? Connect & push</summary>
        <pre><code>git remote add origin https://github.com/&lt;your-username&gt;/&lt;your-repo&gt;.git
git push -u origin main</code></pre>
      </details>
    </section>

    <!-- Repo layout -->
    <section class="card">
      <h2>Repo Layout</h2>
      <p>Primary surfaces and where things live.</p>
      <button class="btn ghost copy-btn" data-copy="#layout" data-label="Copy Tree">Copy</button>
      <pre id="layout"><code>.
├─ apps/
│  └─ grower-ui/          # Static site for your public sandbox (GitHub Pages)
│     ├─ index.html
│     └─ assets/
│        ├─ style.css
│        ├─ script.js     # Defines module cards
│        └─ modules/
│           ├─ signal/
│           ├─ playground/
│           └─ git/       # ← this page
├─ analytics/
│  ├─ ga4/measurement_plan.md
│  └─ gtm/container_README.md
├─ models/sql/            # dbt/SQL models
├─ dashboards/powerbi/
├─ data/sample/
├─ docs/ARCHITECTURE.md, ROADMAP.md
└─ .github/workflows/pages.yml  # Deploys apps/grower-ui on push to main</code></pre>
    </section>

    <!-- Pages deploy -->
    <section class="card">
      <h2>Deploy to GitHub Pages</h2>
      <ol>
        <li>Push to <code>main</code>. The included workflow <span class="kbd">Deploy Pages</span> runs automatically.</li>
        <li>In <span class="kbd">Settings → Pages</span>, set “Build and deployment” to <strong>GitHub Actions</strong>.</li>
        <li>Visit your Pages URL (e.g., <code>https://&lt;user&gt;.github.io/&lt;repo&gt;/</code>).</li>
      </ol>
      <p class="small">The workflow uploads <code>apps/grower-ui</code> as the site artifact and publishes it.</p>
      <div class="row">
        <button class="btn ghost copy-btn" data-copy="#pages-yml" data-label="Copy workflow">Copy workflow</button>
      </div>
      <pre id="pages-yml"><code>name: Deploy Pages
on:
  push: { branches: [ main ] }
  workflow_dispatch:
permissions: { contents: read, pages: write, id-token: write }
concurrency: { group: "pages", cancel-in-progress: false }
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/configure-pages@v5
      - uses: actions/upload-pages-artifact@v3
        with: { path: ./apps/grower-ui }
  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment: { name: github-pages, url: ${{ steps.deployment.outputs.page_url }} }
    steps:
      - id: deployment
        uses: actions/deploy-pages@v4</code></pre>
    </section>

    <!-- GA4 / GTM -->
    <section class="card">
      <h2>GA4 / GTM Notes</h2>
      <ul>
        <li>The site boots <code>window.dataLayer</code>. Add either GTM <em>or</em> GA4 gtag — avoid double-tagging.</li>
        <li>Use the <em>Signal</em> and <em>Playground</em> modules to fire <code>cta_click</code>, <code>form_submit</code>, <code>nav_search</code>, <code>page_view</code>.</li>
        <li>Keep events PII-free; validate with GTM Preview + GA4 DebugView.</li>
      </ul>
      <div class="row">
        <a class="btn" href="../signal/">Open The Signal →</a>
        <a class="btn ghost" href="../playground/">Open UX Playground →</a>
      </div>
    </section>

    <!-- Conventions -->
    <section class="card">
      <h2>Conventional Commits</h2>
      <p class="small">Keep clean history and meaningful deploy notes.</p>
      <pre><code>feat: add Fitness RoutineIQ module
fix: correct GA4 config id in index.html
docs: expand measurement_plan.md with nav_search params
chore: bump Pages workflow to v4
refactor: extract module card renderer</code></pre>
    </section>

    <!-- Troubleshooting -->
    <section class="card">
      <h2>Troubleshooting</h2>
      <details>
        <summary><strong>Remote “origin” already exists</strong></summary>
        <pre><code>git remote remove origin
git remote add origin https://github.com/&lt;user&gt;/&lt;repo&gt;.git</code></pre>
      </details>
      <details>
        <summary><strong>Branch isn’t “main”</strong></summary>
        <pre><code>git branch -m main</code></pre>
      </details>
      <details>
        <summary><strong>Force redeploy Pages (artifact cache issues)</strong></summary>
        <pre><code>git commit --allow-empty -m "chore: trigger pages"
git push</code></pre>
      </details>
    </section>
  </div>

  <footer class="wrap footer">
    <span>© 2025 The Grower — MIT License</span>
  </footer>

  <script>
    // Copy-to-clipboard + analytics cta_click
    function copyText(selector, label) {
      const el = document.querySelector(selector);
      if (!el) return;
      const text = el.innerText;
      navigator.clipboard.writeText(text).then(() => {
        push("cta_click", { id: "copy", label, location: "git" });
      });
    }
    document.querySelectorAll(".copy-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        copyText(btn.getAttribute("data-copy"), btn.getAttribute("data-label") || "Copy");
      });
    });
  </script>
</body>
</html>
